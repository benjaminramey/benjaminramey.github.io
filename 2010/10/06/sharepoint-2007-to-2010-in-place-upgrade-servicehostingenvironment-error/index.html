<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/37b3f20555b3dcfb.css" as="style"/><link rel="stylesheet" href="/_next/static/css/37b3f20555b3dcfb.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-e70c6273bfe3f237.js" defer=""></script><script src="/_next/static/chunks/main-4011ba79f13e7457.js" defer=""></script><script src="/_next/static/chunks/pages/_app-ce8c41266b210471.js" defer=""></script><script src="/_next/static/chunks/61-425b38ade8d8eadf.js" defer=""></script><script src="/_next/static/chunks/388-1e496dfd41235e8f.js" defer=""></script><script src="/_next/static/chunks/314-535fae6e035750df.js" defer=""></script><script src="/_next/static/chunks/pages/%5B...slug%5D-f75c9ae4d92bd42c.js" defer=""></script><script src="/_next/static/Ys88lq9Tazg1dRB8PHdV9/_buildManifest.js" defer=""></script><script src="/_next/static/Ys88lq9Tazg1dRB8PHdV9/_ssgManifest.js" defer=""></script><script src="/_next/static/Ys88lq9Tazg1dRB8PHdV9/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><div><header><div class="container"><div class="d-flex justify-content-between align-item-center"><a class="d-flex justify-content-start align-items-center mr-2" href="/"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%2740%27%20height=%2740%27/%3e"/></span><img alt="Gravatar" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="Gravatar" src="https://en.gravatar.com/userimage/738990/32d8e61848233a67f5e02dcc43be0ff8.jpeg" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span><span class="ml-2">Ben Ramey&#x27;s Blog</span></a><div class="d-none d-sm-flex flex-column justify-content-around ml-2"><small>Scripture, programming problems, solutions and stories.</small></div></div></div></header><nav class="main"><div class="container d-flex justify-content-center"><a href="/archive/">archive</a><a href="/tags/">tags</a><a href="/categories/">categories</a></div></nav><main><div class="container"><article class="post"><h1 class="post-title">SharePoint 2007 to 2010 in-place upgrade serviceHostingEnvironment error</h1><div class="post-info d-flex justify-content-start"><time dateTime="2010-10-06T06:00:00Z" class="post-date">Wed Oct 6th, 2010<!-- -->, <!-- -->over 11 years<!-- --> ago</time><nav class="post-tags"><a href="/tags/sharepoint/">#<!-- -->sharepoint</a></nav><nav class="post-categories"><span>posted in:</span><a href="/categories/programming/">programming</a></nav></div><div><p>I’m testing an in-place SharePoint 2007 to SharePoint 2010 upgrade today and I came across this odd error during the update process.</p>
<p>I successfully installed SharePoint 2010 and proceeded to run the configuration wizard which updates 2007 to 2010. The configuration process would always fail with an error in the Central Administration web.config file. Viewing the configuration log file (the configuration wizard provided the location of it) turned up the error.</p>
<p>Apparently, at some point in the process the configuration wizard looks for the serviceHostingEnvironment element under the <code>&#x3C;system.serviceModel></code> section in the Central Administration web.config.</p>
<div class="remark-highlight"><pre class="language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>serviceHostingEnvironment</span> <span class="token attr-name">aspNetCompatibilityEnabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>”true”</span> <span class="token punctuation">/></span></span>
</code></pre></div>
<p>If it doesn’t find it adds it itself, but curiously, it wraps it in an incomplete system.serviceModel tag so it looks like this:</p>
<div class="remark-highlight"><pre class="language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>system.serviceModel</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>serviceHostingEnvironment</span> <span class="token attr-name">aspNetCompatibilityEnabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>”true”</span> <span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>system.serviceModel</span><span class="token punctuation">></span></span>
</code></pre></div>
<p>This then caused the configuration wizard to bomb out.</p>
<p>The simple solution was to just add the <code>&#x3C;serviceHostingEnvironment aspNetCompatibilityEnabled=”true” /></code> element under my existing <code>&#x3C;system.serviceModel></code> section. The wizard completed just fine after this.</p>
</div></article><section class="comments"><a id="comments-section"><h2>Comments</h2></a><div id="disqus_thread"></div></section></div></main><footer class="footer"><div class="container"><hr/><small>© <time dateTime="2022-06-03T00:02:17.457Z">2022</time>. All rights reserved.</small></div><script async="" defer="" data-website-id="b5832ded-a501-4aab-b4ce-ef0373a1a887" src="https://umami.benramey.com/umami.js"></script></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"tags":["sharepoint"],"categories":["programming"],"title":"SharePoint 2007 to 2010 in-place upgrade serviceHostingEnvironment error","contentHtml":"\u003cp\u003eI’m testing an in-place SharePoint 2007 to SharePoint 2010 upgrade today and I came across this odd error during the update process.\u003c/p\u003e\n\u003cp\u003eI successfully installed SharePoint 2010 and proceeded to run the configuration wizard which updates 2007 to 2010. The configuration process would always fail with an error in the Central Administration web.config file. Viewing the configuration log file (the configuration wizard provided the location of it) turned up the error.\u003c/p\u003e\n\u003cp\u003eApparently, at some point in the process the configuration wizard looks for the serviceHostingEnvironment element under the \u003ccode\u003e\u0026#x3C;system.serviceModel\u003e\u003c/code\u003e section in the Central Administration web.config.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-xml\"\u003e\u003ccode class=\"language-xml\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003eserviceHostingEnvironment\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003easpNetCompatibilityEnabled\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e”true”\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e/\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIf it doesn’t find it adds it itself, but curiously, it wraps it in an incomplete system.serviceModel tag so it looks like this:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-xml\"\u003e\u003ccode class=\"language-xml\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003esystem.serviceModel\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003eserviceHostingEnvironment\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003easpNetCompatibilityEnabled\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e”true”\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e/\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003esystem.serviceModel\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis then caused the configuration wizard to bomb out.\u003c/p\u003e\n\u003cp\u003eThe simple solution was to just add the \u003ccode\u003e\u0026#x3C;serviceHostingEnvironment aspNetCompatibilityEnabled=”true” /\u003e\u003c/code\u003e element under my existing \u003ccode\u003e\u0026#x3C;system.serviceModel\u003e\u003c/code\u003e section. The wizard completed just fine after this.\u003c/p\u003e\n","date":"2010-10-06T06:00:00Z","slug":"/2010/10/06/sharepoint-2007-to-2010-in-place-upgrade-servicehostingenvironment-error"},"__N_SSG":true},"page":"/[...slug]","query":{"slug":["2010","10","06","sharepoint-2007-to-2010-in-place-upgrade-servicehostingenvironment-error"]},"buildId":"Ys88lq9Tazg1dRB8PHdV9","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>