{"pageProps":{"tags":["nuget","git"],"categories":["programming"],"title":"Using NuGetPackager 0.5.5 with GitVersionTask 3.4.1","contentHtml":"<p>I'm using both <a href=\"https://www.nuget.org/packages/NuGetPackager/\">NuGetPackager</a>\nwith <a href=\"https://www.nuget.org/packages/GitVersionTask/\">GitVersionTask</a> on\nmy project that provides EntityFramework persisters for NServiceBus:\n<a href=\"https://github.com/benjaminramey/GoodlyFere.NServiceBus.EntityFramework\">GoodlyFere.NServiceBus.EntityFramework</a>.</p>\n<p>NuGetPackager seems to work seamlessly with GitVersionTask 2.0.0. However,\nGitVersionTask is up to version 3.4.1 and I just hate sitting at a version that\nfar behind!</p>\n<p>So, I updated my NuGet package to the latest version of GitVersionTask. That's\n3.4.1 right now. Too bad, so sad! That caused this error:</p>\n<div class=\"remark-highlight\"><pre class=\"language-xml\"><code class=\"language-xml\">The \"CreatePackages\" task was not given a value for the required parameter \"Version\".\t1\n</code></pre></div>\n<h2>The Problem</h2>\n<p>The problem turns out that NuGetPackager 0.5.5 is looking for a MSBuild property\ncalled \"GfvNuGetVersion\". See the code in the .targets file <a href=\"https://github.com/Particular/NuGetPackager/blob/0.5.6/src/NuGetPackager/NuGetPackager.targets#L5\">here</a>.</p>\n<p>GitVersionTask 3.4.1 (somewhere in a release since 2.0.0) changed that property\nname to \"GitVersion_NuGetVersion\". See the code <a href=\"https://github.com/GitTools/GitVersion/blob/master/src/GitVersionTask/NugetAssets/GitVersionTask.targets#L68\">here</a>.</p>\n<h2>The Solution</h2>\n<p>So, how to fix this? NuGetPackager will probably be updated some day, but for\nnow you can just translate the property in your .csproj file before the\nCreatePackage task is called in NuGetPackager.</p>\n<p>Open up your .csproj file directly in some text editor like Notepad++. Find\nthese two lines at the bottom of the file:</p>\n<div class=\"remark-highlight\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;</span>Import</span> <span class=\"token attr-name\">Project</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>..\\packages\\GitVersionTask.3.4.1\\Build\\dotnet\\GitVersionTask.targets<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\">Condition</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Exists(<span class=\"token punctuation\">'</span>..\\packages\\GitVersionTask.3.4.1\\Build\\dotnet\\GitVersionTask.targets<span class=\"token punctuation\">'</span>)<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;</span>Import</span> <span class=\"token attr-name\">Project</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>..\\packages\\NuGetPackager.0.5.5\\build\\NuGetPackager.targets<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\">Condition</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Exists(<span class=\"token punctuation\">'</span>..\\packages\\NuGetPackager.0.5.5\\build\\NuGetPackager.targets<span class=\"token punctuation\">'</span>)<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n</code></pre></div>\n<p>Before those two lines, add a target and a property group. The target will\ncreate a task that translates the new property to the new property. The\nproperty group wil define a BuildDependsOn to call that target before the\nCreatePackages target is called.</p>\n<div class=\"remark-highlight\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;</span>Target</span> <span class=\"token attr-name\">Name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>TranslateNugetVersion<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\">Condition</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token punctuation\">'</span>$(Configuration)<span class=\"token punctuation\">'</span> == <span class=\"token punctuation\">'</span>Release<span class=\"token punctuation\">'</span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;</span>CreateProperty</span>\n        <span class=\"token attr-name\">Value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>$(GitVersion_NuGetVersion)<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;</span>Output</span>\n            <span class=\"token attr-name\">TaskParameter</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Value<span class=\"token punctuation\">\"</span></span>\n            <span class=\"token attr-name\">PropertyName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>GfvNuGetVersion<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;/</span>CreateProperty</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;/</span>Target</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;</span>PropertyGroup</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;</span>BuildDependsOn</span><span class=\"token punctuation\">></span></span>\n        $(BuildDependsOn);\n        TranslateNugetVersion\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;/</span>BuildDependsOn</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;/</span>PropertyGroup</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;</span>Import</span> <span class=\"token attr-name\">Project</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>..\\packages\\GitVersionTask.3.4.1\\Build\\dotnet\\GitVersionTask.targets<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\">Condition</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Exists(<span class=\"token punctuation\">'</span>..\\packages\\GitVersionTask.3.4.1\\Build\\dotnet\\GitVersionTask.targets<span class=\"token punctuation\">'</span>)<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;</span>Import</span> <span class=\"token attr-name\">Project</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>..\\packages\\NuGetPackager.0.5.5\\build\\NuGetPackager.targets<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\">Condition</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Exists(<span class=\"token punctuation\">'</span>..\\packages\\NuGetPackager.0.5.5\\build\\NuGetPackager.targets<span class=\"token punctuation\">'</span>)<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n</code></pre></div>\n<p>Now, when you build your project, everything should work great!</p>\n","date":"2016-03-03T06:00:00Z","slug":"/2016/03/03/using-nugetpackager-0.5.5-with-gitversiontask-3.4.1"},"__N_SSG":true}